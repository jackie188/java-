
<!-- TOC -->

- [Flink实时数据仓库项目总结](#flink实时数据仓库项目总结)
  - [第一章总结](#第一章总结)
    - [普通的实时计算和实时数仓的比较](#普通的实时计算和实时数仓的比较)
  - [说说你对实时数仓的理解或者看法](#说说你对实时数仓的理解或者看法)
  - [介绍以下数仓分层](#介绍以下数仓分层)
    - [实时数仓](#实时数仓)
    - [离线数仓](#离线数仓)
  - [数据仓库为什么要分层？](#数据仓库为什么要分层)
  - [离线计算和实时计算的比较](#离线计算和实时计算的比较)
  - [实时架构和离线架构](#实时架构和离线架构)
    - [离线架构](#离线架构)
    - [实时架构](#实时架构)

<!-- /TOC -->

## Flink实时数据仓库项目总结

### 第一章总结

#### 普通的实时计算和实时数仓的比较

这个题从**时效性**和**复用性**进行回答：

普通实时计算：时效性好，但是计算的复用性很差。没有保留中间结果。

实时数仓：时效性可能不是很好，但是中间的计算结果得到保留，数据的复用性很好。

### 说说你对实时数仓的理解或者看法

抓住分层这个概念，从分层引出，分两个部分：
- 数据分层
- 计算分层

### 介绍以下数仓分层

把离线数仓和实时数仓分开来说：

#### 实时数仓

实时数仓中，我们一般将数据分为五层：

ODS：数据原始层，存放行为数据(日志)和业务数据，那么在实时数仓中，通常将ods层的数据存储kafka的主题当中。

DWD：我们一般将业务数据的事实表数据存放在DWD层的kafka中，而将业务数据中的维度表数据存放在DIM层，通常存储在Hbase数据库中。

**问题：为什么没有把维度表数据存储在kafka的主题当中呢？**

两个原因
1. kafka中数据存放时间有限制
2. 根据id取Kafka中查询数据很困难。

DIM：DIM和DWD层其实是一层的，只不过存放的数据不一样，并且数据存放的位置也不一样。

DWM：DWM算是DWD层数据到DWS层数据的中间过渡数据，这一部分数据依然算是明细数据，将DWD和DIM层数据进行轻度的加工，形成一个宽表，但是本质上还是明细数据。

DWS：按照主题将事实表数据进行聚合操作，形成一个以主题为单位的宽表，为ods层的数据查询做准备。

ODS:这一层可以认为是我们的需求，直接根据需求取查询数据即可

#### 离线数仓

ODS(Operation Data Store)：原始数据层，存放原始数据，直接加载原始日志、数据，数据保持原貌不做处理，这部分数据一般存储在文件系统的HDFS中。

DWD(data warehouse detail)：对ODS层数据进行清洗（去除空值，脏数据，超过极限范围的数据）、脱敏等。保存业务事实明细，一行信息代表一次业务行为，例如一次下单。

DIM层，维度层，保存维度数据，主要是对业务事实的描述信息，例如何人，何时，何地等

DWS(data warehouse service):以DWD为基础，按天进行轻度汇总。一行信息代表一个主题对象一天的汇总行为，例如一个用户一天下单次数

DWT(data warehouse Topic):以DWS为基础，对数据进行累积汇总。一行信息代表一个主题对象的累积行为，例如一个用户从注册那天开始至今一共下了多少次单

ADS(Application Data Store):为各种统计报表提供数据

**为什么实时数仓中没有DWT层？**

因为实时数仓是来一条数据处理一条数据，不需要宝轮历史数据。

### 数据仓库为什么要分层？

1. **复杂的问题简单化**

将复杂的任务分解成多层来完成，每一层只处理简单的任务，方便定位问题。

2. **减少重复开发**

规范数据分层，通过的中间层数据，能够减少极大的重复计算，增加一次计算结果的复用性。

3. **隔离原始数据**

不论是数据的异常还是数据的敏感性，使真实数据与统计数据解耦开。

![20211205181322](https://vscodepic.oss-cn-beijing.aliyuncs.com/pic/20211205181322.png)

### 离线计算和实时计算的比较

**离线计算**

数据输入确定，计算数据量较大，时间长，统计的指标较多，从技术角度来说，属于批处理计算。

**实时计算**

输入数据不确定的，计算数据量相对小，计算时间短，更加注重用户的体验，以及用户的交互性，从技术角度来说，属于流处理。

**即席查询**

强调查询的临时性，需求的临时性。

presto:当场计算，基于内存速度快。

kylin:预计算，提前计算好。做多维度分析(hive with cube),数据有多种维度，那么kylin会把所有的维度组合全部计算好。需要的时候直接拿去即可。


### 实时架构和离线架构

#### 离线架构

日志：使用flume+kafka+flume--->hdfs

业务数据：sqoop--->hdfs


#### 实时架构

日志：日志服务器--->kafka

业务数据：mysql+Flink CDC--->kafka



